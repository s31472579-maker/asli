<!DOCTYPE html>
<html lang="fa" dir="rtl" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="بارمان مرکب کویر - بزرگترین مرجع تامین مصالح ساختمانی در یزد و جنوب کشور. سیمان، آجر، هبلکس و آهن آلات با بهترین قیمت." />
  <meta name="keywords" content="مصالح ساختمانی, سیمان, آجر, هبلکس, یزد, بارمان مرکب, آهن آلات, ساخت و ساز" />
  <meta name="author" content="Barman Morakab Kavir Team" />
  <title>بارمان مرکب کویر | مرجع تخصصی مصالح ساختمانی</title>
  
  <!-- فونت وزیر متن -->
  <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" />
  <!-- آیکون‌های باکس آیکون -->
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  
  <style>
    /* =========================================
       1. تنظیمات اصلی و متغیرها (VARIABLES)
       ========================================= */
    :root {
      --bg-body: #f8fafc;
      --bg-card: rgba(255, 255, 255, 0.95);
      --bg-input: #ffffff;
      --text-main: #334155;
      --text-light: #64748b;
      --text-muted: #94a3b8;
      
      --primary-dark: #0f172a;
      --primary-mid: #1e293b;
      --primary-green: #059669;
      --primary-green-light: #10b981;
      --primary-green-dark: #047857;
      
      --accent-gold: #FFD700;
      --accent-orange: #f59e0b;
      --accent-red: #ef4444;
      --accent-blue: #3b82f6;
      
      --glass-nav: rgba(15, 23, 42, 0.9);
      --glass-card: rgba(255, 255, 255, 0.7);
      --border-color: #e2e8f0;
      --border-focus: #059669;
      
      --accordion-bg: #f1f5f9;
      --footer-bg: #0f172a;
      --modal-overlay: rgba(0, 0, 0, 0.85);
      
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-glow: 0 0 15px rgba(5, 150, 105, 0.3);
    }

    [data-theme="dark"] {
      --bg-body: #0f172a;
      --bg-card: rgba(30, 41, 59, 0.95);
      --bg-input: #1e293b;
      --text-main: #f1f5f9;
      --text-light: #cbd5e1;
      --text-muted: #64748b;
      
      --primary-dark: #020617;
      --primary-mid: #1e293b;
      --primary-green: #10b981;
      --primary-green-light: #34d399;
      --primary-green-dark: #059669;
      
      --glass-nav: rgba(0, 0, 0, 0.8);
      --glass-card: rgba(30, 41, 59, 0.7);
      --border-color: #334155;
      --border-focus: #10b981;
      
      --accordion-bg: #1e293b;
      --footer-bg: #020617;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.3);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
    }
    
    /* =========================================
       2. ریست و استایل‌های پایه (RESET & BASE)
       ========================================= */
    * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; font-size: 16px; }
    body { 
      font-family: 'Vazirmatn', sans-serif; margin: 0; 
      background-color: var(--bg-body); 
      background-image: radial-gradient(var(--border-color) 1px, transparent 1px); 
      background-size: 40px 40px; 
      color: var(--text-main); line-height: 1.8; overflow-x: hidden; 
      transition: background-color 0.3s, color 0.3s; 
      min-height: 100vh; display: flex; flex-direction: column;
    }
    ul, ol { list-style: none; }
    a { text-decoration: none; color: inherit; transition: 0.3s; }
    button { font-family: inherit; cursor: pointer; }
    img { max-width: 100%; height: auto; display: block; }
    
    ::-webkit-scrollbar { width: 10px; height: 10px; } 
    ::-webkit-scrollbar-track { background: var(--bg-body); } 
    ::-webkit-scrollbar-thumb { background: var(--primary-green); border-radius: 5px; border: 2px solid var(--bg-body); }
    ::-webkit-scrollbar-thumb:hover { background: var(--primary-green-dark); }

    /* =========================================
       3. کلاس‌های کاربردی (UTILITIES)
       ========================================= */
    .text-center { text-align: center; }
    .text-right { text-align: right; }
    .text-justify { text-align: justify; }
    .flex { display: flex; }
    .flex-col { flex-direction: column; }
    .items-center { align-items: center; }
    .justify-center { justify-content: center; }
    .justify-between { justify-content: space-between; }
    .gap-10 { gap: 10px; }
    .mt-10 { margin-top: 10px; } .mt-20 { margin-top: 20px; }
    .mb-10 { margin-bottom: 10px; } .mb-20 { margin-bottom: 20px; }
    .w-full { width: 100%; }
    .hidden { display: none !important; }
    
    .row { display: flex; flex-wrap: wrap; margin: 0 -10px; }
    .col { padding: 0 10px; flex: 1; }
    .col-12 { width: 100%; flex: 0 0 100%; }
    .col-6 { width: 50%; flex: 0 0 50%; }
    .col-4 { width: 33.33%; flex: 0 0 33.33%; }
    
    @media (max-width: 768px) {
        .col-6, .col-4 { width: 100%; flex: 0 0 100%; margin-bottom: 20px; }
        .row { margin: 0; }
        .col { padding: 0; }
    }

    /* =========================================
       4. انیمیشن‌ها و لودر
       ========================================= */
    #progress-container { position: fixed; top: 0; left: 0; width: 100%; height: 4px; z-index: 99999; }
    #progress-bar { height: 100%; background: var(--accent-gold); width: 0%; box-shadow: 0 0 10px var(--accent-gold); transition: width 0.1s; }
    
    #preloader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #0f172a; z-index: 9999; display: flex; justify-content: center; align-items: center; transition: opacity 0.5s; }
    .loader { width: 50px; height: 50px; border: 5px solid #FFF; border-bottom-color: var(--accent-gold); border-radius: 50%; animation: rotation 1s linear infinite; }
    @keyframes rotation { 100% { transform: rotate(360deg); } }
    @keyframes fadeInUpSmooth { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }

    /* =========================================
       5. هدر و نویگیشن
       ========================================= */
    header { position: relative; height: 90vh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; color: white; border-radius: 0 0 60px 60px; background: linear-gradient(135deg, #064e3b, #0f172a); box-shadow: 0 10px 40px rgba(0,0,0,0.2); overflow: hidden; margin-bottom: 50px; }
    #hero-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0.35; pointer-events: none; }
    header h1 { font-size: clamp(2.5rem, 7vw, 5rem); margin: 0; z-index: 2; background: linear-gradient(to bottom, #ffffff, #a7f3d0); -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: fadeInUpSmooth 1s ease-out forwards; text-shadow: 0 10px 20px rgba(0,0,0,0.2); }
    header p { z-index: 2; font-size: clamp(1rem, 2vw, 1.5rem); margin-top: 15px; color: #e2e8f0; animation: fadeInUpSmooth 1s ease-out 0.3s forwards; opacity: 0; }
    
    .scroll-down-icon { position: absolute; bottom: 30px; font-size: 2rem; color: rgba(255,255,255,0.7); animation: bounce 2s infinite; cursor: pointer; z-index: 10; }
    @keyframes bounce { 0%, 20%, 50%, 80%, 100% {transform: translateY(0);} 40% {transform: translateY(-10px);} 60% {transform: translateY(-5px);} }

    nav { position: fixed; top: 25px; left: 0; right: 0; margin: auto; width: fit-content; background: var(--glass-nav); backdrop-filter: blur(10px); padding: 6px 12px; border-radius: 50px; z-index: 1000; display: flex; gap: 5px; border: 1px solid rgba(255,255,255,0.08); box-shadow: 0 10px 30px rgba(0,0,0,0.2); max-width: 95%; overflow-x: auto; }
    nav::-webkit-scrollbar { display: none; }
    nav a, nav button { color: #cbd5e1; text-decoration: none; display: flex; flex-direction: column; align-items: center; font-size: 0.75rem; padding: 8px 12px; border-radius: 20px; transition: 0.3s; background: none; border: none; cursor: pointer; font-family: inherit; white-space: nowrap; min-width: 60px; }
    nav a i, nav button i { font-size: 1.4rem; margin-bottom: 2px; }
    nav a:hover, nav button:hover, nav a.active { color: white; background: rgba(255,255,255,0.15); transform: translateY(-2px); }

    /* =========================================
       6. کانتینرها و کارت‌ها
       ========================================= */
    .container { max-width: 1200px; margin: -100px auto 50px; padding: 0 20px; position: relative; z-index: 10; display: flex; flex-direction: column; gap: 60px; }
    .card { background: var(--bg-card); border-radius: 30px; padding: 40px; box-shadow: var(--shadow-lg); border: 1px solid var(--border-color); position: relative; overflow: hidden; transition: 0.3s ease; backdrop-filter: blur(5px); }
    .card:hover { border-color: var(--primary-green); box-shadow: var(--shadow-glow); }
    .section-title { display: flex; align-items: center; gap: 15px; margin-bottom: 30px; padding-bottom: 15px; border-bottom: 1px solid var(--border-color); }
    .section-title i { font-size: 2rem; color: var(--primary-green); background: rgba(5,150,105,0.1); padding: 10px; border-radius: 12px; }
    .section-title h2 { margin: 0; font-size: 1.8rem; color: var(--text-main); }

    /* =========================================
       7. بخش آمار
       ========================================= */
    .stats-container { display: flex; flex-wrap: wrap; justify-content: space-around; gap: 20px; margin-top: 30px; padding-top: 20px; border-top: 1px dashed var(--border-color); text-align: center; }
    .stat-box { flex: 1; min-width: 140px; padding: 15px; transition: 0.3s; }
    .stat-box:hover { transform: translateY(-5px); }
    .stat-number { font-size: 2.5rem; font-weight: 900; color: var(--primary-green); display: block; line-height: 1; }
    .stat-label { color: var(--text-light); font-size: 0.9rem; font-weight: bold; margin-top: 5px; display: block; }

    /* =========================================
       8. گرید محصولات
       ========================================= */
    .cat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 25px; margin-top: 20px; }
    .cat-item { background: var(--bg-card); padding: 30px 20px; border-radius: 25px; text-align: center; border: 1px solid var(--border-color); transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); position: relative; overflow: hidden; cursor: default; }
    .cat-item:hover { transform: translateY(-10px); box-shadow: 0 20px 40px -5px rgba(0,0,0,0.1); border-color: transparent; }
    
    .cat-icon-box { width: 80px; height: 80px; margin: 0 auto 20px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; transition: 0.4s; position: relative; z-index: 1; border: 2px solid transparent; }
    .icon-cement { background: #e2e8f0; color: #475569; }
    .icon-heblex { background: #dbeafe; color: #2563eb; }
    .icon-brick { background: #ffedd5; color: #ea580c; }
    .icon-plaster { background: #f3f4f6; color: #9ca3af; }
    .icon-sand { background: #fef9c3; color: #ca8a04; }
    .icon-steel { background: #f1f5f9; color: #334155; border-color: #cbd5e1; }
    .icon-iso { background: #f3e8ff; color: #9333ea; }
    .icon-glue { background: #dcfce7; color: #166534; }
    
    .cat-item:hover .cat-icon-box { transform: scale(1.1) rotate(10deg); border-color: currentColor; background: transparent; }
    .cat-item h4 { font-size: 1.2rem; margin: 0 0 10px; color: var(--text-main); font-weight: 800; }
    .cat-item p { font-size: 0.85rem; margin: 0; font-weight: bold; padding: 5px 12px; border-radius: 12px; display: inline-block; }
    .status-ok { color: var(--primary-green); background: rgba(5,150,105,0.1); }
    .status-no { color: var(--accent-red); background: rgba(239,68,68,0.1); }

    .price-action-bar { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; background: var(--bg-body); padding: 20px; border-radius: 18px; margin-top: 30px; border: 1px solid var(--border-color); gap: 15px; }
    .btn-open-price { background: var(--primary-dark); color: white; border: none; padding: 12px 25px; border-radius: 12px; cursor: pointer; font-weight: bold; display: flex; align-items: center; gap: 8px; transition: 0.3s; font-size: 1rem; }
    .btn-open-price:hover { background: var(--primary-green); transform: translateY(-3px); box-shadow: 0 10px 20px rgba(5,150,105,0.3); }

    /* =========================================
       9. فرم‌ها
       ========================================= */
    .form-group { margin-bottom: 15px; }
    .form-control { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid var(--border-color); background: var(--bg-input); color: var(--text-main); font-family: inherit; transition: 0.3s; }
    .form-control:focus { border-color: var(--primary-green); box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.1); }

    /* =========================================
       10. وبلاگ
       ========================================= */
    .blog-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
    .blog-card { background: var(--bg-body); border-radius: 20px; overflow: hidden; border: 1px solid var(--border-color); transition: 0.3s; display: flex; flex-direction: column; }
    .blog-card:hover { transform: translateY(-5px); border-color: var(--primary-green); }
    .blog-img { height: 180px; background: #cbd5e1; display: flex; align-items: center; justify-content: center; color: #64748b; font-size: 3rem; }
    .blog-content { padding: 20px; flex: 1; display: flex; flex-direction: column; }
    .blog-date { font-size: 0.8rem; color: var(--text-light); margin-bottom: 10px; display: block; }
    .blog-title { font-size: 1.1rem; font-weight: bold; margin-bottom: 10px; color: var(--text-main); }
    .blog-excerpt { font-size: 0.9rem; color: var(--text-muted); margin-bottom: 20px; flex: 1; }
    .blog-btn { align-self: flex-start; color: var(--primary-green); font-weight: bold; font-size: 0.9rem; display: flex; align-items: center; gap: 5px; cursor: pointer; background: none; border: none; padding: 0; font-family: inherit; }

    /* استایل مودال وبلاگ */
    .blog-modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 4000; display: none; justify-content: center; align-items: center; backdrop-filter: blur(4px); opacity: 0; transition: opacity 0.3s; }
    .blog-modal-overlay.active { display: flex; opacity: 1; }
    .blog-modal-box { background: var(--bg-card); width: 90%; max-width: 800px; height: 80vh; border-radius: 20px; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.5); transform: scale(0.9); transition: transform 0.3s; }
    .blog-modal-overlay.active .blog-modal-box { transform: scale(1); }
    .blog-modal-header { background: var(--primary-green); color: white; padding: 20px; display: flex; justify-content: space-between; align-items: center; font-weight: bold; font-size: 1.1rem; }
    .blog-modal-body { flex: 1; padding: 30px; overflow-y: auto; text-align: justify; line-height: 2; font-size: 1rem; color: var(--text-main); }
    .blog-modal-body h4 { margin-top: 20px; margin-bottom: 10px; color: var(--primary-dark); }
    .blog-modal-body ul { list-style: disc; padding-right: 20px; margin-bottom: 15px; }
    .blog-modal-footer { padding: 15px 30px; border-top: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; background: var(--bg-body); }

    /* =========================================
       11. تماس و فوتر
       ========================================= */
    .contact-wrapper { display: flex; flex-wrap: wrap; justify-content: center; gap: 30px; margin-top: 30px; }
    .contact-info-card { background: var(--bg-card); padding: 30px; border-radius: 25px; flex: 1 1 300px; max-width: 380px; display: flex; flex-direction: column; align-items: center; text-align: center; gap: 15px; transition: 0.4s; border: 1px solid var(--border-color); }
    .contact-info-card:hover { transform: translateY(-5px); border-color: var(--primary-green); box-shadow: 0 15px 30px rgba(5, 150, 105, 0.1); }
    .contact-icon { width: 70px; height: 70px; background: var(--bg-body); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; color: var(--primary-green); }
    .contact-btn { display: inline-flex; align-items: center; gap: 8px; padding: 10px 25px; border-radius: 12px; margin-top: auto; text-decoration: none; font-size: 0.9rem; font-weight: bold; transition: 0.3s; }
    .btn-call { background: #dcfce7; color: #166534; } .btn-call:hover { background: #166534; color: white; }

    footer { background: var(--footer-bg); color: #94a3b8; padding: 60px 20px 20px; margin-top: 80px; border-radius: 50px 50px 0 0; position: relative; }
    .footer-content { display: flex; flex-wrap: wrap; max-width: 1200px; margin: 0 auto; gap: 40px; justify-content: space-between; }
    .footer-col { flex: 1; min-width: 250px; }
    .footer-col h3 { color: white; margin-bottom: 20px; font-size: 1.2rem; border-right: 3px solid var(--primary-green); padding-right: 10px; }
    .footer-links a { display: block; color: #94a3b8; margin-bottom: 10px; transition: 0.3s; }
    .footer-links a:hover { color: var(--primary-green); padding-right: 5px; }
    .footer-bottom { border-top: 1px solid rgba(255,255,255,0.1); margin-top: 40px; padding-top: 20px; text-align: center; font-size: 0.9rem; display: flex; justify-content: space-between; flex-wrap: wrap; gap: 10px; }
    .social-links { display: flex; gap: 10px; }
    .social-links a { width: 35px; height: 35px; background: rgba(255,255,255,0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; transition: 0.3s; }
    .social-links a:hover { background: var(--primary-green); transform: scale(1.1); }

    /* =========================================
       12. المان‌های شناور و مودال‌ها
       ========================================= */
    .float-container { position: fixed; bottom: 20px; left: 20px; z-index: 2000; display: flex; flex-direction: column; gap: 15px; }
    .float-btn { width: 55px; height: 55px; border-radius: 50%; color: white; border: none; font-size: 24px; cursor: pointer; display: flex; justify-content: center; align-items: center; box-shadow: 0 8px 20px rgba(0,0,0,0.2); transition: 0.3s; text-decoration: none; position: relative; }
    .float-btn:hover { transform: scale(1.1); }
    .chat-btn { background: #10b981; } 
    .review-btn { background: #3b82f6; }
    
    .tooltip { position: absolute; right: 65px; background: rgba(0,0,0,0.8); color: white; padding: 5px 10px; border-radius: 5px; font-size: 0.8rem; white-space: nowrap; opacity: 0; visibility: hidden; transition: 0.3s; pointer-events: none; }
    .float-btn:hover .tooltip { opacity: 1; visibility: visible; right: 70px; }

    #backToTop { position: fixed; bottom: 20px; left: 85px; width: 45px; height: 45px; background: var(--primary-dark); color: white; border-radius: 50%; display: none; justify-content: center; align-items: center; cursor: pointer; z-index: 1999; box-shadow: 0 5px 15px rgba(0,0,0,0.2); transition: 0.3s; }
    
    .price-modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2100; display: none; justify-content: center; align-items: center; backdrop-filter: blur(5px); opacity: 0; transition: opacity 0.3s; }
    .price-modal-overlay.active { display: flex; opacity: 1; }
    
    .price-modal-box { background: var(--bg-card); width: 95%; max-width: 900px; border-radius: 25px; overflow: hidden; display: flex; flex-direction: column; height: 90vh; max-height: 90vh; color: var(--text-main); position: relative; box-shadow: 0 25px 50px rgba(0,0,0,0.5); transform: scale(0.9); transition: transform 0.3s; }
    .price-modal-overlay.active .price-modal-box { transform: scale(1); }
    
    .price-modal-header { background: var(--primary-dark); color: white; padding: 20px; display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
    .modern-table { width: 100%; border-collapse: collapse; min-width: 500px; }
    .modern-table th { background: var(--bg-body); padding: 15px; text-align: right; position: sticky; top: 0; color: var(--text-main); z-index: 10; font-weight: 800; border-bottom: 2px solid var(--border-color); }
    .modern-table td { padding: 12px 15px; border-bottom: 1px solid var(--border-color); color: var(--text-main); transition: 0.2s; }
    .modern-table tr:hover td { background: rgba(5,150,105,0.05); }
    
    .table-scroll-container { flex: 1; overflow-y: auto; -webkit-overflow-scrolling: touch; overscroll-behavior: contain; border: 1px solid var(--border-color); border-radius: 10px; margin: 15px; padding-bottom: 60px; background: var(--bg-body); }
    
    .accordion-item { border: 1px solid var(--border-color); border-radius: 10px; overflow: hidden; margin-bottom: 5px; background: var(--bg-input); }
    .accordion-header { background: var(--accordion-bg); padding: 15px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: bold; transition: 0.3s; }
    .accordion-header:hover { background: #e2e8f0; }
    .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-out; padding: 0 15px; opacity: 0; }
    .accordion-content.active { max-height: 800px; opacity: 1; padding: 15px; border-top: 1px solid var(--border-color); }
    
    .login-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 3000; display: none; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
    .login-box { background: white; padding: 40px; border-radius: 20px; width: 350px; text-align: center; border-top: 5px solid var(--accent-gold); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); animation: fadeInUpSmooth 0.4s; }
    .login-input { width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 8px; border: 1px solid #cbd5e1; font-family: inherit; }
    
    .admin-float-btn { position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px; background: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; z-index: 2001; color: #cbd5e1; border: 2px solid #fff; box-shadow: 0 5px 15px rgba(0,0,0,0.1); transition: 0.3s; }
    .admin-float-btn:hover { color: var(--primary-dark); transform: rotate(90deg); }
    
    .calc-float-btn { position: fixed; bottom: 85px; right: 20px; width: 50px; height: 50px; background: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; z-index: 2001; color: var(--accent-blue); border: 2px solid #fff; box-shadow: 0 5px 15px rgba(0,0,0,0.1); transition: 0.3s; }
    .calc-float-btn:hover { transform: scale(1.1); color: var(--primary-dark); }

    #toast { visibility: hidden; min-width: 280px; background-color: #333; color: #fff; text-align: center; border-radius: 50px; padding: 16px; position: fixed; z-index: 10000; left: 50%; bottom: 30px; transform: translateX(-50%); font-size: 1rem; opacity: 0; transition: 0.5s; box-shadow: 0 10px 20px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; gap: 10px; }
    #toast.show { visibility: visible; opacity: 1; bottom: 60px; }
    #toast.success { background-color: var(--primary-green); } 
    #toast.error { background-color: var(--accent-red); } 

    .star-rating { display: flex; justify-content: center; gap: 5px; margin-bottom: 15px; direction: ltr; }
    .star-rating i { font-size: 2rem; color: #cbd5e1; cursor: pointer; transition: 0.2s; }
    .star-rating i:hover, .star-rating i.active { color: var(--accent-gold); transform: scale(1.2); }
    .review-stars-display { color: var(--accent-gold); font-size: 0.9rem; letter-spacing: 1px; direction: ltr; }

    @media (max-width: 480px) {
        .card { padding: 25px 15px; }
        header h1 { font-size: 2.2rem; }
        .section-title { flex-direction: column; align-items: flex-start; gap: 10px; }
        .btn-open-price { width: 100%; justify-content: center; }
        .price-modal-box { width: 100%; height: 100%; border-radius: 0; }
        nav { bottom: 10px; top: auto; width: 95%; justify-content: space-around; }
        nav a span { font-size: 0.65rem; }
        .container { margin-bottom: 80px; }
        
        /* -------------------------------------------
           تغییرات بهینه‌سازی شده برای موبایل
           ------------------------------------------- */
           
        /* 1. بهینه‌سازی ماشین حساب */
        .calc-box {
            width: 92% !important; /* عرض درصدی برای پر کردن صفحه */
            max-width: 350px;      /* جلوگیری از بزرگ شدن بیش از حد */
            padding: 15px;         /* کمی کاهش پدینگ */
        }
        .calc-box.scientific {
            width: 98% !important; /* در حالت مهندسی تقریبا کل صفحه را بگیرد */
        }
        /* تنظیم اندازه دکمه‌ها در حالت مهندسی */
        .calc-keys button {
            height: 45px;
            font-size: 1.1rem;
        }

        /* 2. انتقال پنل شناور به بالا (چپ) */
        .float-container {
            bottom: auto !important; /* حذف موقعیت پایین */
            top: 110px;             /* قرارگیری در بالا (زیر هدر) */
            left: 15px;
        }
        /* تنظیم تولتیپ برای پنل بالا */
        .tooltip {
            top: 50%;
            transform: translateY(-50%);
        }
    }
    /* استایل مودال جدید وبلاگ */
.blog-modal-overlay { 
  position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
  background: rgba(0,0,0,0.85); z-index: 5000; 
  display: none; justify-content: center; align-items: center; 
  backdrop-filter: blur(8px); opacity: 0; transition: 0.3s; 
}
.blog-modal-overlay.active { display: flex; opacity: 1; }
.blog-modal-box { 
  background: var(--bg-card); width: 90%; max-width: 750px; 
  height: 85vh; border-radius: 25px; display: flex; 
  flex-direction: column; overflow: hidden; box-shadow: 0 25px 60px rgba(0,0,0,0.5); 
  transform: translateY(30px); transition: 0.3s;
}
.blog-modal-overlay.active .blog-modal-box { transform: translateY(0); }
.blog-modal-header { 
  background: var(--primary-green); color: white; padding: 20px; 
  display: flex; justify-content: space-between; align-items: center; 
  font-weight: bold; font-size: 1.2rem;
}
.blog-modal-body { 
  flex: 1; padding: 35px; overflow-y: auto; text-align: justify; 
  line-height: 2; font-size: 1rem; color: var(--text-main); 
}
.blog-modal-body h4 { color: var(--primary-green); margin-top: 25px; margin-bottom: 10px; border-right: 4px solid var(--primary-green); padding-right: 12px; }
.blog-modal-body ul { margin-bottom: 20px; padding-right: 30px; list-style-type: circle; }

    /* استایل چاپ */
    @media print {
        header, nav, .float-container, #backToTop, .admin-float-btn, .calc-float-btn, .btn-open-price, footer { display: none !important; }
        .container { margin: 0; padding: 0; }
        .card { box-shadow: none; border: none; padding: 0; }
        body { background: white; color: black; }
        .cat-grid { display: block; }
        .cat-item { page-break-inside: avoid; border: 1px solid #000; margin-bottom: 10px; display: flex; align-items: center; gap: 20px; text-align: right; padding: 10px; }
        .cat-icon-box { margin: 0; width: 40px; height: 40px; font-size: 1.5rem; }
    }

    .admin-toggle-header { background: #fff7ed; border: 1px solid #fed7aa; color: #d97706; padding: 12px 15px; border-radius: 12px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: bold; transition: 0.3s; margin-bottom: 5px; }
    .admin-toggle-header:hover { background: #ffedd5; box-shadow: 0 4px 10px rgba(217, 119, 6, 0.1); }
    .admin-toggle-header.active { border-radius: 12px 12px 0 0; border-bottom: none; background: #ffedd5; }
    .admin-dashboard-body { background: #fff7ed; border: 1px solid #fed7aa; border-top: none; border-radius: 0 0 12px 12px; max-height: 0; overflow: hidden; opacity: 0; transition: all 0.4s ease-in-out; padding: 0 15px; }
    .admin-dashboard-body.open { max-height: 1000px; opacity: 1; padding: 15px; margin-bottom: 15px; }
    .rotate-icon { transition: transform 0.3s; }
    .admin-toggle-header.active .rotate-icon { transform: rotate(180deg); }
    
    .calc-modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 6000; display: none; justify-content: center; align-items: center; backdrop-filter: blur(5px); opacity: 0; transition: opacity 0.3s; }
    .calc-modal-overlay.active { display: flex; opacity: 1; }
    .calc-box { background: var(--bg-card); width: 320px; border-radius: 20px; padding: 20px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); border: 1px solid var(--border-color); transition: width 0.3s; }
    .calc-box.scientific { width: 450px; }
    .calc-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; color: var(--text-main); font-weight: bold; font-size: 1.1rem; }
    #calcDisplay { width: 100%; height: 60px; background: var(--bg-input); border: 1px solid var(--border-color); border-radius: 10px; text-align: left; padding: 10px 15px; font-size: 1.5rem; font-family: monospace; color: var(--text-main); margin-bottom: 15px; direction: ltr; }
    .calc-mode-toggle button { width: 100%; padding: 8px; margin-bottom: 15px; background: rgba(59, 130, 246, 0.1); color: var(--accent-blue); border: 1px solid var(--accent-blue); border-radius: 10px; cursor: pointer; font-size: 0.85rem; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 5px; }
    .calc-mode-toggle button:hover { background: var(--accent-blue); color: white; }
    .calc-keys { display: flex; flex-direction: column; gap: 10px; }
    .std-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
    .sci-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 5px; border-bottom: 1px dashed var(--border-color); padding-bottom: 10px; }
    .sci-row.hidden { display: none; }
    .calc-keys button { height: 50px; border-radius: 12px; border: none; font-size: 1.2rem; cursor: pointer; background: var(--bg-body); color: var(--text-main); box-shadow: 0 4px 0 rgba(0,0,0,0.1); transition: 0.1s; }
    .calc-keys button:active { transform: translateY(4px); box-shadow: none; }
    .btn-op { background: #e0f2fe !important; color: #0284c7 !important; }
    .btn-green { background: var(--primary-green) !important; color: white !important; }
    .btn-red { background: #fee2e2 !important; color: #dc2626 !important; }
    .btn-orange { background: #ffedd5 !important; color: #ea580c !important; }
    .btn-sci { background: #334155 !important; color: #e2e8f0 !important; font-size: 0.9rem !important; }
    @media (max-width: 480px) { .calc-box.scientific { width: 95%; } }
  </style>
</head>
<body onload="initSite()">

    <!-- مودال نمایش متن کامل وبلاگ -->
<div class="blog-modal-overlay" id="blogModal" onclick="closeBlog()">
    <div class="blog-modal-box" onclick="event.stopPropagation()">
        <div class="blog-modal-header">
            <span id="blogFullTitle">عنوان مقاله</span>
            <i class='bx bx-x' onclick="closeBlog()" style="cursor:pointer; font-size:1.8rem;"></i>
        </div>
        <div class="blog-modal-body" id="blogFullContent">
            <!-- محتوای مقاله توسط جاوااسکریپت اینجا قرار می‌گیرد -->
        </div>
        <div class="blog-modal-footer">
            <span id="blogFullDate" style="font-size:0.8rem; color:var(--text-light)"></span>
            <button onclick="closeBlog()" class="btn-open-price" style="padding: 5px 15px; font-size: 0.8rem;">بستن مقاله</button>
        </div>
    </div>
</div>

<!-- لودر و پروگرس بار -->
<div id="progress-container"><div id="progress-bar"></div></div>
<div id="preloader"><span class="loader"></span></div>
<div id="toast"><i class='bx bx-check-circle'></i> <span id="toast-msg">پیام</span></div>

<!-- هدر اصلی -->
<header>
  <canvas id="hero-canvas"></canvas>
  <div style="z-index: 2; padding: 0 20px;">
    <h1>بارمان مرکب کویر</h1>
    <p>تامین تخصصی متریال ساختمانی با استانداردهای جهانی و قیمت رقابتی</p>
  </div>
  <i class='bx bx-chevrons-down scroll-down-icon' onclick="document.getElementById('about').scrollIntoView()"></i>
</header>

<!-- نویگیشن -->
<nav>
  <button onclick="toggleTheme()" title="تغییر تم"><i id="theme-icon" class='bx bx-moon'></i><span>تم</span></button>
  <a href="#about" class="active"><i class='bx bx-buildings'></i><span>درباره</span></a>
  <a href="#products"><i class='bx bx-package'></i><span>محصولات</span></a>
  <a href="#contact"><i class='bx bx-support'></i><span>تماس</span></a>
</nav>

<!-- بدنه اصلی -->
<div class="container">
  
  <!-- بخش درباره ما و آمار -->
  <section id="about" class="card">
    <div class="section-title">
        <i class='bx bxs-business'></i>
        <div>
            <h2>درباره مجموعه بارمان</h2>
            <span style="font-size:0.8rem; color:var(--text-light)">پیشرو در صنعت ساختمان استان یزد</span>
        </div>
    </div>
    <div class="row">
        <div class="col-6">
            <p class="text-justify">
                شرکت بارمان مرکب کویر با تکیه بر سال‌ها تجربه در قلب کویر یزد، زنجیره تامین مصالح را متحول کرده است. ما با حذف واسطه‌ها و ارتباط مستقیم با کارخانجات تولیدی سیمان، آجر و فولاد، تضمین می‌کنیم که محصولات با بالاترین کیفیت و پایین‌ترین قیمت به دست سازندگان عزیز برسد.
            </p>
            <p class="text-justify mt-10">
                ماموریت ما فراتر از فروش است؛ ما مشاور شما در انتخاب بهینه مصالح برای کاهش هزینه‌های سربار و افزایش عمر مفید سازه هستیم.
            </p>
        </div>
        <div class="col-6">
            <div class="stats-container">
                <div class="stat-box"><span id="stat-customers" class="stat-number" data-target="1200">0</span><span class="stat-label">مشتری راضی</span></div>
                <div class="stat-box"><span id="stat-projects" class="stat-number" data-target="500">0</span><span class="stat-label">پروژه موفق</span></div>
                <div class="stat-box"><span id="stat-experience" class="stat-number" data-target="15">0</span><span class="stat-label">سال تجربه</span></div>
                <div class="stat-box"><span id="stat-tons" class="stat-number" data-target="2500">0</span><span class="stat-label">تامین تن کالا</span></div>
            </div>
        </div>
    </div>
    
    <div class="price-action-bar">
        <div style="display:flex; align-items:center; gap:10px;">
            <i class='bx bxs-check-shield' style="font-size:1.5rem; color:var(--primary-green)"></i>
            <span style="font-weight:bold; color:var(--text-main)">گارانتی اصالت و سلامت کالا</span>
        </div>
        <button class="btn-open-price" onclick="togglePriceModal()">
            <i class='bx bx-table'></i> استعلام لحظه‌ای قیمت
        </button>
    </div>
  </section>

  <!-- بخش محصولات -->
  <section id="products" class="card">
    <div class="section-title">
        <i class='bx bx-package'></i>
        <h2>دسته‌بندی محصولات</h2>
    </div>
    <p style="color:var(--text-light); margin-bottom:20px;">جامع‌ترین سبد کالایی مصالح ساختمانی در جنوب کشور</p>
    <div class="cat-grid" id="mainProductGrid">
        <!-- این بخش توسط جاوااسکریپت پر می‌شود -->
    </div>
  </section>

  <!-- بخش فروش ویژه -->
  <section id="special-sale" class="card" style="border-color: var(--accent-gold);">
    <div class="section-title">
        <i class='bx bxs-offer' style="color:var(--accent-red)"></i>
        <h2 style="color:var(--accent-red)">پیشنهادات شگفت‌انگیز</h2>
    </div>
    <div class="row">
        <div class="col-4">
            <div class="cat-item" style="border: 2px dashed var(--accent-red);">
                <div class="cat-icon-box icon-heblex"><i class='bx bxs-cuboid'></i></div>
                <h3>پوکه هبلکس</h3>
                <p>عایق صوت و حرارت فوق‌العاده</p>
                <div style="margin-top:10px; color:var(--accent-red); font-weight:bold;">15% تخفیف</div>
            </div>
        </div>
        <div class="col-4">
            <div class="cat-item" style="border: 2px dashed var(--accent-red);">
                <div class="cat-icon-box icon-sand"><i class='bx bxs-layer'></i></div>
                <h3>پوکه لیکا</h3>
                <p>سبک‌سازی سازه تا 30%</p>
                <div style="margin-top:10px; color:var(--accent-red); font-weight:bold;">ارسال فوری</div>
            </div>
        </div>
        <div class="col-4">
            <div class="cat-item" style="border: 2px dashed var(--accent-red);">
                <div class="cat-icon-box icon-glue"><i class='bx bxs-truck'></i></div>
                <h3>حمل رایگان</h3>
                <p>برای سفارشات بالای 20 تن</p>
                <div style="margin-top:10px; color:var(--accent-red); font-weight:bold;">ویژه همکاران</div>
            </div>
        </div>
    </div>
  </section>

  <!-- بخش وبلاگ (با قابلیت کلیک) -->
  <section id="blog" class="card">
    <div class="section-title">
        <i class='bx bx-news'></i>
        <h2>تازه‌های صنعت ساختمان</h2>
    </div>
    <div class="blog-grid">
        <article class="blog-card">
            <div class="blog-img"><i class='bx bx-building'></i></div>
            <div class="blog-content">
                <span class="blog-date">1402/10/01</span>
                <h3 class="blog-title">مزایای استفاده از بلوک هبلکس</h3>
                <p class="blog-excerpt">بلوک‌های سبک اتوکلاو شده یا هبلکس، جایگزینی عالی برای آجر و سفال سنتی هستند که سرعت اجرا را تا 3 برابر افزایش می‌دهند...</p>
                <button onclick="openBlog(1)" class="blog-btn">ادامه مطلب <i class='bx bx-left-arrow-alt'></i></button>
            </div>
        </article>
        <article class="blog-card">
            <div class="blog-img"><i class='bx bx-trending-up'></i></div>
            <div class="blog-content">
                <span class="blog-date">1402/09/25</span>
                <h3 class="blog-title">تحلیل قیمت سیمان در زمستان</h3>
                <p class="blog-excerpt">با توجه به محدودیت‌های گاز صنایع در فصل سرما، پیش‌بینی می‌شود قیمت سیمان با نوساناتی همراه باشد. راهکارهای ذخیره‌سازی...</p>
                <button onclick="openBlog(2)" class="blog-btn">ادامه مطلب <i class='bx bx-left-arrow-alt'></i></button>
            </div>
        </article>
        <article class="blog-card">
            <div class="blog-img"><i class='bx bx-paint'></i></div>
            <div class="blog-content">
                <span class="blog-date">1402/09/10</span>
                <h3 class="blog-title">راهنمای انتخاب چسب کاشی</h3>
                <p class="blog-excerpt">چسب‌های پودری و خمیری هر کدام کاربرد خاص خود را دارند. برای محیط‌های مرطوب مثل استخر حتما باید از چسب‌های پلیمری استفاده کرد...</p>
                <button onclick="openBlog(3)" class="blog-btn">ادامه مطلب <i class='bx bx-left-arrow-alt'></i></button>
            </div>
        </article>
    </div>
  </section>

  <!-- بخش سوالات متداول (FAQ) -->
  <section id="faq" class="card">
    <div class="section-title">
        <i class='bx bx-question-mark'></i>
        <h2>سوالات متداول</h2>
    </div>
    <div class="accordion-item">
        <div class="accordion-header" onclick="toggleAccordion('faq1', this)">
            <span>آیا ارسال به شهرستان هم دارید؟</span>
            <i class='bx bx-chevron-left'></i>
        </div>
        <div id="faq1" class="accordion-content">
            <p>بله، بارمان مرکب کویر با داشتن ناوگان حمل و نقل طرف قرارداد، امکان ارسال بار به سراسر ایران را با کمترین نرخ بارنامه فراهم کرده است.</p>
        </div>
    </div>
    <div class="accordion-item">
        <div class="accordion-header" onclick="toggleAccordion('faq2', this)">
            <span>حداقل حجم سفارش چقدر است؟</span>
            <i class='bx bx-chevron-left'></i>
        </div>
        <div id="faq2" class="accordion-content">
            <p>برای محصولاتی مثل آجر و سیمان فروش به صورت عمده (نیسان، خاور، تریلی) می‌باشد. برای چسب و افزودنی‌ها فروش خرده نیز امکان‌پذیر است.</p>
        </div>
    </div>
    <div class="accordion-item">
        <div class="accordion-header" onclick="toggleAccordion('faq3', this)">
            <span>شرایط پرداخت چگونه است؟</span>
            <i class='bx bx-chevron-left'></i>
        </div>
        <div id="faq3" class="accordion-content">
            <p>تسویه حساب معمولاً قبل از بارگیری انجام می‌شود. برای پروژه‌های بزرگ و همکاران دائمی، شرایط اعتباری و چکی طبق ضوابط شرکت قابل بررسی است.</p>
        </div>
    </div>
  </section>

  <!-- بخش تماس با ما -->
  <section id="contact" class="card">
    <div style="text-align:center; margin-bottom:20px;">
      <h2>ارتباط با ما</h2>
      <p style="margin:0;">پاسخگویی سریع و مشاوره رایگان در تمام ایام هفته</p>
    </div>
    <div class="contact-wrapper">
        <div class="contact-info-card">
            <div class="contact-icon"><i class='bx bxs-user-voice'></i></div>
            <div class="contact-text"><h4>مدیر کل</h4><a href="tel:09132536157" class="contact-btn btn-call"><i class='bx bxs-phone'></i> 09132536157</a></div>
        </div>
        <div class="contact-info-card">
            <div class="contact-icon"><i class='bx bxs-user-detail'></i></div>
            <div class="contact-text"><h4>مدیر فروش</h4><a href="tel:09135256776" class="contact-btn btn-call"><i class='bx bxs-phone'></i> 09135256776</a></div>
        </div>
        <div class="contact-info-card">
            <div class="contact-icon"><i class='bx bxs-map'></i></div>
            <div class="contact-text"><h4>دفتر مرکزی</h4><p>یزد، بلوار استقلال، میدان کسنویه، خیابان گلشن</p></div>
        </div>
    </div>
    
    <!-- فرم درخواست تماس -->
    <div style="margin-top:40px; border-top:1px solid var(--border-color); padding-top:30px;">

        </form>
    </div>
  </section>

</div>

<!-- فوتر کامل -->
<footer>
    <div class="footer-content">
        <div class="footer-col">
            <h3>درباره ما</h3>
            <p style="text-align:justify; font-size:0.9rem;">
                بارمان مرکب کویر نماد اعتماد در صنعت ساختمان یزد. ما متعهد به تامین پایدار و باکیفیت مصالح برای سازندگان فردا هستیم. کیفیت را با ما تجربه کنید.
            </p>
        </div>
        <div class="footer-col">
            <h3>دسترسی سریع</h3>
            <div class="footer-links">
                <a href="#products">محصولات</a>
                <a href="#about">درباره ما</a>
                <a href="#contact">تماس با ما</a>
                <a href="#" onclick="openReviewModal()">ثبت شکایات</a>
            </div>
        </div>
        <div class="footer-col">
            <h3>محصولات پرفروش</h3>
            <div class="footer-links">
                <a href="#">سیمان تیپ 2</a>
                <a href="#">آجر سفال یزد</a>
                <a href="#">بلوک هبلکس رضوی</a>
                <a href="#">چسب کاشی پودری</a>
            </div>
        </div>
        <div class="footer-col">
            <h3>شبکه‌های اجتماعی</h3>
            <div class="social-links">
                <a href="https://eitaa.com/AMojtabaMoosavi"><i class='bx bxs-message-rounded-dots'></i></a>
                <a href="#"><i class='bx bxl-instagram'></i></a>
                <a href="#"><i class='bx bxl-telegram'></i></a>
                <a href="#"><i class='bx bxl-whatsapp'></i></a>
            </div>
            <p style="margin-top:20px; font-size:0.8rem;">عضویت در خبرنامه:</p>
            <div style="display:flex; gap:5px;">
                <input type="email" placeholder="ایمیل..." class="form-control" style="font-size:0.8rem; padding:8px;">
                <button style="background:var(--primary-green); border:none; border-radius:8px; color:white; padding:0 10px;"><i class='bx bx-send'></i></button>
            </div>
        </div>
    </div>
    <div class="footer-bottom">
        <span>&copy; 1402 بارمان مرکب کویر | تمام حقوق محفوظ است.</span>
        <span>طراحی و توسعه: تیم فنی بارمان</span>
    </div>
</footer>

<!-- المان‌های شناور -->
<div id="backToTop" onclick="window.scrollTo(0,0)"><i class='bx bx-up-arrow-alt'></i></div>

<!-- دکمه شناور ماشین حساب (سمت راست - بالای دکمه ادمین) -->
<div class="calc-float-btn" onclick="openCalculator()">
    <i class='bx bx-calculator'></i>
</div>

<!-- دکمه ورود ادمین (سمت راست - پایین) -->
<div class="admin-float-btn" onclick="document.getElementById('loginModal').style.display='flex'"><i class='bx bxs-cog'></i></div>

<!-- کانتینر دکمه‌های چپ (در موبایل به بالا می‌رود) -->
<div class="float-container">
    <button class="float-btn review-btn" onclick="openReviewModal()">
        <i class='bx bxs-edit'></i>
        <span class="tooltip">ثبت نظر</span>
    </button>
    <a href="https://eitaa.com/AMojtabaMoosavi" target="_blank" class="float-btn chat-btn">
        <i class='bx bxs-message-rounded-dots'></i>
        <span class="tooltip">مشاوره آنلاین</span>
    </a>
</div>

<!-- =========================
     MODALS (پنجره‌های پاپ‌آپ)
     ========================= -->
     
<!-- مودال ماشین حساب کامل -->
<div class="calc-modal-overlay" id="calcModalOverlay">
    <div class="calc-box">
        <div class="calc-header">
            <span><i class='bx bx-calculator'></i> ماشین حساب</span>
            <i class='bx bx-x' style="cursor:pointer; font-size:1.5rem;" onclick="closeCalculator()"></i>
        </div>
        
        <input type="text" id="calcDisplay" readonly placeholder="0">
        
        <div class="calc-mode-toggle">
            <button id="btnSciToggle" onclick="toggleScientificMode()">
                <i class='bx bx-microchip'></i> فعال‌سازی حالت مهندسی
            </button>
        </div>

        <div class="calc-keys">
            <!-- ردیف مهندسی (مخفی در ابتدا) -->
            <div class="sci-row hidden" id="sciKeys">
                <button class="btn-sci" onclick="calcInput('sin(')">sin</button>
                <button class="btn-sci" onclick="calcInput('cos(')">cos</button>
                <button class="btn-sci" onclick="calcInput('tan(')">tan</button>
                <button class="btn-sci" onclick="calcInput('log(')">log</button>
                <button class="btn-sci" onclick="calcInput('sqrt(')">√</button>
                <button class="btn-sci" onclick="calcInput('^')">^</button>
                <button class="btn-sci" onclick="calcInput('PI')">π</button>
                <button class="btn-sci" onclick="calcInput('(')">(</button>
            </div>

            <!-- دکمه‌های استاندارد -->
            <div class="std-grid">
                <button class="btn-red" onclick="calcClear()">C</button>
                <button onclick="calcInput('/')" class="btn-op">÷</button>
                <button onclick="calcInput('*')" class="btn-op">×</button>
                <button onclick="calcDelete()" class="btn-orange"><i class='bx bx-backspace'></i></button>
                
                <button onclick="calcInput('7')">7</button>
                <button onclick="calcInput('8')">8</button>
                <button onclick="calcInput('9')">9</button>
                <button onclick="calcInput('-')" class="btn-op">-</button>
                
                <button onclick="calcInput('4')">4</button>
                <button onclick="calcInput('5')">5</button>
                <button onclick="calcInput('6')">6</button>
                <button onclick="calcInput('+')" class="btn-op">+</button>
                
                <button onclick="calcInput('1')">1</button>
                <button onclick="calcInput('2')">2</button>
                <button onclick="calcInput('3')">3</button>
                <button onclick="calcResult()" class="btn-green" style="grid-row: span 2;">=</button>
                
                <button onclick="calcInput('%')">%</button>
                <button onclick="calcInput('0')">0</button>
                <button onclick="calcInput('.')">.</button>
            </div>
        </div>
    </div>
</div>

<!-- مودال ثبت نظر -->
<div class="review-submit-modal" id="reviewSubmitModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:3100; justify-content:center; align-items:center; backdrop-filter:blur(3px);">
    <div class="review-box" style="background:var(--bg-card); padding:25px; border-radius:20px; width:90%; max-width:400px; text-align:center; box-shadow:0 10px 30px rgba(0,0,0,0.3);">
        <h3 style="color:var(--text-main)">ثبت تجربه خرید</h3>
        <p style="font-size:0.8rem; color:var(--text-light)">به خدمات ما امتیاز دهید</p>
        
        <div class="star-rating" id="starContainer">
             <i class='bx bx-star' onclick="setRating(1)" id="star-1"></i>
             <i class='bx bx-star' onclick="setRating(2)" id="star-2"></i>
             <i class='bx bx-star' onclick="setRating(3)" id="star-3"></i>
             <i class='bx bx-star' onclick="setRating(4)" id="star-4"></i>
             <i class='bx bx-star' onclick="setRating(5)" id="star-5"></i>
        </div>

        <input type="text" id="reviewName" class="login-input" placeholder="نام شما (اختیاری)">
        <textarea id="reviewText" class="login-input" style="height:100px; resize:none;" placeholder="نظر خود را بنویسید..."></textarea>
        <div style="display:flex; gap:10px;">
            <button onclick="submitReview()" style="flex:1; padding:10px; background:var(--primary-green); color:white; border:none; border-radius:10px; cursor:pointer;">ارسال</button>
            <button onclick="document.getElementById('reviewSubmitModal').style.display='none'" style="flex:1; padding:10px; background:var(--bg-body); color:var(--text-main); border:1px solid var(--border-color); border-radius:10px; cursor:pointer;">بستن</button>
        </div>
    </div>
</div>

<!-- مودال لیست نظرات (Admin Only) -->
<div class="review-list-modal" id="reviewListModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:3200; justify-content:center; align-items:center;">
    <div class="review-list-box" style="background:var(--bg-card); width:95%; max-width:600px; height:80vh; border-radius:20px; display:flex; flex-direction:column; overflow:hidden;">
        <div class="price-modal-header">
            <span>مدیریت نظرات کاربران</span>
            <i class='bx bx-x' onclick="document.getElementById('reviewListModal').style.display='none'" style="cursor:pointer; font-size:1.5rem;"></i>
        </div>
        <div class="review-scroll" id="reviewListContainer" style="flex:1; overflow-y:auto; padding:20px;">
            <!-- محتوا توسط JS -->
        </div>
    </div>
</div>

<!-- مودال ورود ادمین -->
<div class="login-modal" id="loginModal">
    <form class="login-box" onsubmit="event.preventDefault(); checkAndLogin();" autocomplete="off">
        <h3>ورود پرسنل</h3>
        <p style="font-size:0.8rem; color:#64748b; margin-bottom:15px;">لطفا اطلاعات ورود خود را وارد کنید</p>
        <div style="position:relative;">
            <i class='bx bx-user' style="position:absolute; top:12px; right:10px; color:#94a3b8;"></i>
            <input type="text" id="adminUser" class="login-input" placeholder="نام کاربری" autocomplete="off" style="padding-right:35px;">
        </div>
        <div style="position:relative;">
            <i class='bx bx-lock-alt' style="position:absolute; top:12px; right:10px; color:#94a3b8;"></i>
            <input type="password" id="adminPass" class="login-input" placeholder="رمز عبور" autocomplete="new-password" style="padding-right:35px;">
        </div>
        <button type="submit" style="width:100%; padding:10px; background:var(--primary-green); color:white; border:none; border-radius:8px; font-weight:bold; cursor:pointer; transition:0.3s;">ورود به پنل</button>
        <button type="button" onclick="document.getElementById('adminUser').value=''; document.getElementById('adminPass').value=''; document.getElementById('loginModal').style.display='none'" style="margin-top:15px; background:none; border:none; color:var(--accent-red); cursor:pointer;">انصراف</button>
    </form>
</div>

<!-- مودال اصلی قیمت و مدیریت -->
<div class="price-modal-overlay" id="priceModal">
    <div class="price-modal-box">
        <div class="price-modal-header">
            <span style="display:flex; align-items:center; gap:10px;"><i class='bx bx-data'></i> جدول قیمت و مدیریت</span>
            <i class='bx bx-x' onclick="togglePriceModal()" style="cursor:pointer; font-size:1.5rem;"></i>
        </div>
        
        <div style="padding: 15px; display:flex; flex-direction:column; height:100%; overflow:hidden;">
            <!-- جستجو -->
            <div style="position:relative; margin-bottom:15px; flex-shrink:0;">
                <input type="text" id="searchInput" placeholder="جستجوی محصول (مثلا: سیمان سفید)..." onkeyup="filterProducts()" style="width:100%; padding:12px 40px 12px 12px; border-radius:10px; border:1px solid #ccc;">
                <i class='bx bx-search' style="position:absolute; right:12px; top:12px; font-size:1.2rem; color:#94a3b8;"></i>
            </div>

            <!-- پنل ادمین (مخفی و جمع‌شو) -->
            <div id="admin-main-wrapper" style="display:none; flex-shrink:0; margin-bottom:10px;">
                
                <!-- دکمه/هدر باز و بسته کردن داشبورد -->
                <div class="admin-toggle-header" onclick="toggleAdminDashboard()">
                    <span style="display:flex; align-items:center; gap:8px;">
                        <i class='bx bxs-dashboard'></i> داشبورد مدیریت و تنظیمات
                    </span>
                    <div style="display:flex; align-items:center; gap:10px;">
                        <span style="font-size:0.75rem; color:#d97706; font-weight:normal;" id="admin-status-text">(بسته)</span>
                        <i id="admin-arrow-icon" class='bx bx-chevron-down rotate-icon' style="font-size:1.4rem;"></i>
                    </div>
                </div>

                <!-- بدنه داشبورد (محتوای اصلی) -->
                <div id="admin-dashboard-content" class="admin-dashboard-body">
                    
                    <!-- نوار ابزار بالا (خروج و نظرات) -->
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px; border-bottom:1px solid #fed7aa; padding-bottom:10px;">
                        <span style="font-size:0.8rem; color:#9a3412;">خوش آمدید، همکار گرامی</span>
                        <div style="display:flex; gap:5px;">
                            <button id="btn-reviews-panel" onclick="showReviewsPanel()" style="display:none; border:none; background:#3b82f6; color:white; border-radius:6px; padding:6px 12px; cursor:pointer; font-size:0.85rem; align-items:center; gap:5px;">
                                <i class='bx bx-comment-detail'></i> نظرات
                            </button>
                            <button onclick="logoutAdmin()" style="border:none; background:#ef4444; color:white; border-radius:6px; padding:6px 12px; cursor:pointer; font-size:0.85rem; display:flex; align-items:center; gap:5px;">
                                <i class='bx bx-log-out'></i> خروج
                            </button>
                        </div>
                    </div>
                    
                    <!-- آکاردئون 1: مدیریت دسته‌بندی -->
                    <div class="accordion-item">
                        <div class="accordion-header" onclick="toggleAccordion('cat-acc', this)">
                            <span><i class='bx bx-grid-alt'></i> نمایش دسته‌بندی‌ها در صفحه اصلی</span>
                            <i class='bx bx-chevron-left'></i>
                        </div>
                        <div id="cat-acc" class="accordion-content">
                            <div id="admin-cat-toggles" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:10px;"></div>
                            <p style="font-size:0.75rem; color:#666; margin-top:10px;">* با برداشتن تیک، دسته‌بندی به عنوان "ناموجود" نمایش داده می‌شود.</p>
                        </div>
                    </div>

                    <!-- آکاردئون 2: ویرایش آمار (برای کاربر 1379 مخفی می‌شود) -->
                    <div class="accordion-item" id="admin-stats-wrapper" style="margin-top:5px;">
                        <div class="accordion-header" onclick="toggleAccordion('stats-acc', this)">
                            <span><i class='bx bx-stats'></i> ویرایش آمار سایت</span>
                            <i class='bx bx-chevron-left'></i>
                        </div>
                        <div id="stats-acc" class="accordion-content">
                            <div style="display:flex; gap:5px; margin-top:5px;">
                                <input id="edit-customers" type="number" placeholder="مشتری" style="flex:1; padding:8px; border-radius:5px; border:1px solid #ccc;">
                                <input id="edit-projects" type="number" placeholder="پروژه" style="flex:1; padding:8px; border-radius:5px; border:1px solid #ccc;">
                                <input id="edit-experience" type="number" placeholder="تجربه" style="flex:1; padding:8px; border-radius:5px; border:1px solid #ccc;">
                            </div>
                            <button onclick="saveSiteStats()" style="width:100%; margin-top:5px; background:#f59e0b; border:none; padding:8px; color:white; border-radius:5px; cursor:pointer;">ذخیره تغییرات آمار</button>
                        </div>
                    </div>

                    <!-- آکاردئون 3: افزودن کالا -->
                    <div class="accordion-item" style="margin-top:5px;">
                        <div class="accordion-header" onclick="toggleAccordion('add-acc', this)">
                            <span id="form-title"><i class='bx bx-plus-circle'></i> افزودن/ویرایش کالا</span>
                            <i class='bx bx-chevron-left'></i>
                        </div>
                        <div id="add-acc" class="accordion-content">
                            <div style="display:flex; flex-wrap:wrap; gap:5px; margin-top:5px;">
                                <input id="new-name" placeholder="نام محصول" style="flex:2; padding:8px; border-radius:5px; border:1px solid #ccc;">
                                <input id="new-unit" placeholder="واحد (مثلا: تن)" style="flex:1; padding:8px; border-radius:5px; border:1px solid #ccc;">
                                <input id="new-price" placeholder="قیمت (تومان)" style="flex:1; padding:8px; border-radius:5px; border:1px solid #ccc;">
                                <select id="new-status" style="padding:8px; border-radius:5px; border:1px solid #ccc;"><option value="ok">موجود</option><option value="call">تماس بگیرید</option></select>
                            </div>
                            <div style="display:flex; gap:5px; margin-top:10px;">
                                <button id="btn-save-prod" onclick="addProductLocal()" style="flex:1; background:green; color:white; border:none; padding:8px; border-radius:5px; cursor:pointer;">افزودن به لیست</button>
                                <button id="btn-cancel-edit" onclick="cancelEdit()" style="display:none; background:#9ca3af; border:none; padding:8px; border-radius:5px; color:white; cursor:pointer;">لغو ویرایش</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- جدول قیمت -->
            <div class="table-scroll-container" id="scrollContainer">
                <table class="modern-table">
                    <thead><tr><th>کالا</th><th>واحد</th><th>قیمت (تومان)</th><th class="admin-col" style="display:none">عملیات</th></tr></thead>
                    <tbody id="priceTableBody"></tbody>
                </table>
            </div>

            <!-- دکمه‌های کنترل اسکرول -->
            <div style="position: absolute; bottom: 30px; left: 30px; display: flex; flex-direction: column; gap: 10px; z-index: 100;">
                <button onclick="scrollTable('top')" style="width: 40px; height: 40px; background: var(--primary-dark); color: white; border-radius: 50%; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center;"><i class='bx bx-chevron-up'></i></button>
                <button onclick="scrollTable('bottom')" style="width: 40px; height: 40px; background: var(--primary-dark); color: white; border-radius: 50%; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center;"><i class='bx bx-chevron-down'></i></button>
            </div>

        </div>
    </div>
</div>

<script>
    /* =========================================
       1. DATASETS (داده‌ها)
       ========================================= */
    const catDefinitions = [
        {key: 'cement', icon: 'icon-cement', icoClass: 'bxs-component', label: 'سیمان و پودر'},
        {key: 'plaster', icon: 'icon-plaster', icoClass: 'bxs-layer', label: 'گچ و خاک'},
        {key: 'brick', icon: 'icon-brick', icoClass: 'bxs-grid-alt', label: 'آجر دستی و فشاری'},
        {key: 'heblex', icon: 'icon-heblex', icoClass: 'bxs-cuboid', label: 'بلوک هبلکس'},
        {key: 'sand', icon: 'icon-sand', icoClass: 'bxs-pyramid', label: 'شن و ماسه'},
        {key: 'glue', icon: 'icon-glue', icoClass: 'bxs-flask', label: 'چسب و افزودنی'},
        {key: 'iso', icon: 'icon-iso', icoClass: 'bxs-droplet', label: 'ایزوگام'},
    ];
    const defaultCatStates = { cement:true, plaster:true, brick:true, heblex:true, sand:true, glue:true, iso:true, steel:true };

    const defaultProducts = [
        // --- سیمان و پودر ---
        { id: 101, name: "سیمان تیپ 2 پاکتی - یزد", unit: "کیسه 50ک", price: "72,500", status: "ok" },
        { id: 102, name: "سیمان تیپ 2 فله - یزد", unit: "تن", price: "1,150,000", status: "ok" },
        { id: 103, name: "سیمان تیپ 5 پاکتی - یزد", unit: "کیسه 50ک", price: "76,000", status: "ok" },
        { id: 104, name: "سیمان سفید - بنوید", unit: "کیسه 40ک", price: "105,000", status: "ok" },
        { id: 105, name: "سیمان سفید - ساوه", unit: "کیسه 40ک", price: "112,000", status: "ok" },
        { id: 106, name: "پودر سنگ سوپر - قم", unit: "کیسه", price: "18,000", status: "ok" },
        { id: 107, name: "سیمان تیپ 1 - فله", unit: "تن", price: "1,080,000", status: "ok" },
        { id: 108, name: "آهک هیدراته صنعتی", unit: "کیسه 30ک", price: "55,000", status: "ok" },
        { id: 109, name: "سیمان پوزولانی - پاکتی", unit: "کیسه 50ک", price: "69,000", status: "ok" },
        { id: 110, name: "سیمان سفید - نی ریز", unit: "کیسه 40ک", price: "102,000", status: "ok" },

        // --- آهن آلات و میلگرد ---
        { id: 201, name: "میلگرد 8 آجدار - A2 بافق", unit: "کیلوگرم", price: "28,200", status: "ok" },
        { id: 202, name: "میلگرد 10 آجدار - A3 بافق", unit: "کیلوگرم", price: "27,900", status: "ok" },
        { id: 203, name: "میلگرد 12 آجدار - A3 یزد", unit: "کیلوگرم", price: "27,500", status: "ok" },
        { id: 204, name: "میلگرد 14 آجدار - A3 احرامیان", unit: "کیلوگرم", price: "27,400", status: "ok" },
        { id: 205, name: "میلگرد 16 آجدار - A3 احرامیان", unit: "کیلوگرم", price: "27,400", status: "ok" },
        { id: 206, name: "میلگرد 18 آجدار - A3 یزد", unit: "کیلوگرم", price: "27,300", status: "ok" },
        { id: 207, name: "میلگرد 20 آجدار - A3 یزد", unit: "کیلوگرم", price: "27,300", status: "ok" },
        { id: 208, name: "تیرآهن 14 - ذوب آهن اصفهان", unit: "شاخه 12م", price: "4,350,000", status: "ok" },
        { id: 209, name: "تیرآهن 16 - ذوب آهن اصفهان", unit: "شاخه 12م", price: "5,400,000", status: "ok" },
        { id: 210, name: "تیرآهن 18 - ذوب آهن اصفهان", unit: "شاخه 12م", price: "6,900,000", status: "ok" },
        { id: 211, name: "نبشی 4*40*40 - یزد", unit: "شاخه 6م", price: "1,150,000", status: "ok" },
        { id: 212, name: "ناودانی 10 - هموزن اروپایی", unit: "شاخه 6م", price: "1,850,000", status: "ok" },
        { id: 213, name: "پروفیل 2*40*40 - جهان", unit: "کیلوگرم", price: "36,500", status: "ok" },
        { id: 214, name: "خاموت آماده - مهندسی", unit: "کیلوگرم", price: "29,500", status: "ok" },
        { id: 215, name: "میلگرد 22 آجدار - یزد", unit: "کیلوگرم", price: "27,300", status: "ok" },
        { id: 216, name: "میلگرد 25 آجدار - یزد", unit: "کیلوگرم", price: "27,450", status: "ok" },

        // --- هبلکس و اتصالات ---
        { id: 301, name: "بلوک هبلکس 10*20*60 - رضوی", unit: "متر مکعب", price: "1,480,000", status: "ok" },
        { id: 302, name: "بلوک هبلکس 15*20*60 - رضوی", unit: "متر مکعب", price: "1,480,000", status: "ok" },
        { id: 303, name: "بلوک هبلکس 20*25*60 - رضوی", unit: "متر مکعب", price: "1,480,000", status: "ok" },
    ];

    /* =========================================
       2. منطق اصلی سایت (CORE LOGIC)
       ========================================= */
    let products = JSON.parse(localStorage.getItem('siteProducts')) || defaultProducts;
    if(products.length === 0) products = defaultProducts;

    function initSite() { 
        document.getElementById('preloader').style.opacity = 0; 
        setTimeout(()=>document.getElementById('preloader').style.display='none', 500);
        
        loadProducts(); 
        initTheme(); 
        initParticles(); 
        loadStats(); 
    }

    // --- مدیریت تم ---
    function toggleTheme() {
        const html = document.documentElement;
        const current = html.getAttribute('data-theme');
        const next = current === 'light' ? 'dark' : 'light';
        html.setAttribute('data-theme', next);
        document.getElementById('theme-icon').className = next === 'light' ? 'bx bx-moon' : 'bx bx-sun';
        localStorage.setItem('theme', next);
    }
    function initTheme() { 
        const saved = localStorage.getItem('theme') || 'light'; 
        document.documentElement.setAttribute('data-theme', saved); 
        document.getElementById('theme-icon').className = saved === 'light' ? 'bx bx-moon' : 'bx bx-sun'; 
    }

    // --- مدیریت آکاردئون ---
    function toggleAccordion(id, header) {
        const content = document.getElementById(id);
        const isActive = content.classList.contains('active');
        
        document.querySelectorAll('.accordion-content').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.accordion-header').forEach(h => {
             h.classList.remove('active');
             h.querySelector('.bx-chevron-left').style.transform = 'rotate(0deg)';
        });

        if(!isActive) { 
            content.classList.add('active'); 
            header.classList.add('active'); 
            header.querySelector('.bx-chevron-left').style.transform = 'rotate(-90deg)';
        }
    }

    // --- مدیریت آمار ---
    const defaultStats = { customers: 1200, projects: 500, experience: 15, tons: 25000 };
    function loadStats() {
        const stats = JSON.parse(localStorage.getItem('siteStats')) || defaultStats;
        updateStat('stat-customers', stats.customers); 
        updateStat('stat-projects', stats.projects); 
        updateStat('stat-experience', stats.experience);
        updateStat('stat-tons', stats.tons || 25000);
        runStatsAnimation();
    }
    function updateStat(id, val){ const el = document.getElementById(id); el.innerText = "0"; el.setAttribute('data-target', val); }
    function runStatsAnimation() {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if(entry.isIntersecting) {
                    const stat = entry.target;
                    const target = +stat.getAttribute('data-target'); 
                    const inc = Math.ceil(target / 100);
                    let current = 0;
                    const timer = setInterval(() => {
                        current += inc;
                        if(current >= target) {
                            stat.innerText = target + "+";
                            clearInterval(timer);
                        } else {
                            stat.innerText = current;
                        }
                    }, 20);
                    observer.unobserve(stat);
                }
            });
        }, { threshold: 0.5 });
        document.querySelectorAll('.stat-number').forEach(el => observer.observe(el));
    }
    function saveSiteStats() {
        const c = document.getElementById('edit-customers').value; 
        const p = document.getElementById('edit-projects').value; 
        const e = document.getElementById('edit-experience').value;
        if(c && p && e) {
            const currentStats = JSON.parse(localStorage.getItem('siteStats')) || defaultStats;
            localStorage.setItem('siteStats', JSON.stringify({ ...currentStats, customers: c, projects: p, experience: e }));
            loadStats(); 
            showToast("آمار ذخیره شد");
        }
    }

    /* =========================================
       3. مدیریت محصولات و ادمین
       ========================================= */
    let isAdminMode = false;
    let editingId = null;

    function loadProducts(list = products) {
        const tbody = document.getElementById('priceTableBody'); 
        tbody.innerHTML = '';
        list.forEach(p => {
            const priceTxt = p.status === 'ok' ? Number(p.price.replace(/,/g,'')).toLocaleString() : 'تماس بگیرید';
            const color = p.status === 'ok' ? 'var(--primary-green)' : 'var(--accent-orange)';
            const actions = `<td class="admin-col" style="display:${isAdminMode?'table-cell':'none'}">
                <div style="display:flex; gap:10px;">
                    <button onclick="editProduct(${p.id})" style="border:none; background:none; cursor:pointer; color:#3b82f6;"><i class='bx bx-edit' style="font-size:1.2rem;"></i></button>
                    <button onclick="deleteProductLocal(${p.id})" style="border:none; background:none; cursor:pointer; color:#ef4444;"><i class='bx bxs-trash' style="font-size:1.2rem;"></i></button>
                </div>
            </td>`;
            tbody.innerHTML += `<tr>
                <td>${p.name}</td>
                <td>${p.unit}</td>
                <td style="color:${color}; font-weight:bold;">${priceTxt}</td>
                ${actions}
            </tr>`;
        });
        renderMainGrid();
    }

    function renderMainGrid() {
        const grid = document.getElementById('mainProductGrid');
        grid.innerHTML = ''; 
        const catStates = JSON.parse(localStorage.getItem('catStates')) || defaultCatStates;
        catDefinitions.forEach(item => {
            const isAvailable = catStates[item.key] !== false; 
            const statusText = isAvailable ? 'موجود ✔️' : 'ناموجود ❌';
            const statusClass = isAvailable ? 'status-ok' : 'status-no';
            grid.innerHTML += `
                <div class="cat-item">
                    <div class="cat-icon-box ${item.icon}">
                        <i class='bx ${item.icoClass}'></i>
                    </div>
                    <h4>${item.label}</h4>
                    <p class="${statusClass}">${statusText}</p>
                </div>
            `;
        });
    }

    function filterProducts() {
        const term = document.getElementById('searchInput').value.toLowerCase();
        loadProducts(products.filter(p => p.name.toLowerCase().includes(term)));
    }

    function toggleAdminDashboard() {
        const header = document.querySelector('.admin-toggle-header');
        const content = document.getElementById('admin-dashboard-content');
        const statusText = document.getElementById('admin-status-text');
        
        const isOpen = content.classList.contains('open');
        
        if (isOpen) {
            content.classList.remove('open');
            header.classList.remove('active');
            statusText.innerText = "(بسته)";
        } else {
            content.classList.add('open');
            header.classList.add('active');
            statusText.innerText = "(باز)";
        }
    }

    function checkAndLogin() {
        const u = document.getElementById('adminUser').value;
        const p = document.getElementById('adminPass').value;

        const validUsers = [
            {u:'1379', p:'1379', role:'admin'},
            {u:'1368', p:'1368', role:'admin'},
            {u:'4422322281', p:'4422322281', role:'superadmin'}
        ];

        const user = validUsers.find(x => x.u === u && x.p === p);

        if (user) {
            isAdminMode = true;
            document.getElementById('loginModal').style.display = 'none';
            
            const adminWrapper = document.getElementById('admin-main-wrapper');
            adminWrapper.style.display = 'block';
            
            setTimeout(() => {
                if(!document.getElementById('admin-dashboard-content').classList.contains('open')){
                    toggleAdminDashboard();
                }
            }, 100);

            document.querySelectorAll('.admin-col').forEach(el => el.style.display = 'table-cell');
            document.getElementById('adminUser').value = '';
            document.getElementById('adminPass').value = '';
            
            togglePriceModal();
            loadProducts(); 
            renderAdminCategoryToggles();
            showToast("خوش آمدید، پنل مدیریت فعال شد", "success");
            
            const reviewBtn = document.getElementById('btn-reviews-panel');
            const statsPanel = document.getElementById('admin-stats-wrapper');

            if(user.role === 'superadmin') {
                reviewBtn.style.display = 'flex';
            } else {
                reviewBtn.style.display = 'none';
            }

            if(user.u === '1379') {
                statsPanel.style.display = 'none';
            } else {
                statsPanel.style.display = 'block';
            }

            const st = JSON.parse(localStorage.getItem('siteStats')) || defaultStats;
            document.getElementById('edit-customers').value = st.customers; 
            document.getElementById('edit-projects').value = st.projects; 
            document.getElementById('edit-experience').value = st.experience;
        } else { 
            showToast("نام کاربری یا رمز عبور اشتباه است", "error"); 
        }
    }

    function logoutAdmin() { 
        isAdminMode = false; 
        const content = document.getElementById('admin-dashboard-content');
        if(content.classList.contains('open')) toggleAdminDashboard(); 
        setTimeout(() => {
            document.getElementById('admin-main-wrapper').style.display = 'none';
        }, 300);
        document.querySelectorAll('.admin-col').forEach(el => el.style.display = 'none');
        loadProducts(); 
        showToast("با موفقیت خارج شدید"); 
    }

    function addProductLocal() {
        const name = document.getElementById('new-name').value;
        const unit = document.getElementById('new-unit').value;
        const price = document.getElementById('new-price').value;
        const status = document.getElementById('new-status').value;
        if(!name) { showToast('نام محصول الزامی است','error'); return; }
        
        if(editingId !== null) {
            const index = products.findIndex(p => p.id === editingId);
            if(index !== -1) products[index] = { id: editingId, name, unit, price, status };
            editingId = null;
            document.getElementById('btn-save-prod').innerText = "افزودن به لیست";
            document.getElementById('btn-save-prod').style.background = "green";
            document.getElementById('btn-cancel-edit').style.display = 'none';
            document.getElementById('form-title').innerHTML = "<i class='bx bx-plus-circle'></i> افزودن کالا";
            showToast('محصول ویرایش شد');
        } else {
            products.push({ id: Date.now(), name, unit, price, status });
            showToast('محصول اضافه شد');
        }
        localStorage.setItem('siteProducts', JSON.stringify(products));
        loadProducts();
        scrollTable('bottom');
        document.getElementById('new-name').value = ''; 
        document.getElementById('new-price').value = '';
    }

    function editProduct(id) {
        const p = products.find(prod => prod.id === id);
        if(!p) return;
        editingId = id;
        document.getElementById('new-name').value = p.name;
        document.getElementById('new-unit').value = p.unit;
        document.getElementById('new-price').value = p.price;
        document.getElementById('new-status').value = p.status;
        
        const btn = document.getElementById('btn-save-prod');
        btn.innerText = "ذخیره تغییرات";
        btn.style.background = "#f59e0b";
        document.getElementById('btn-cancel-edit').style.display = 'inline-block';
        document.getElementById('form-title').innerHTML = "<i class='bx bx-edit'></i> ویرایش کالا";
        
        const acc = document.getElementById('add-acc');
        const head = document.getElementById('form-title').parentNode;
        if(!acc.classList.contains('active')) toggleAccordion('add-acc', head);
        head.scrollIntoView({behavior: "smooth"});
    }

    function cancelEdit() {
        editingId = null;
        document.getElementById('new-name').value = ''; 
        document.getElementById('new-price').value = '';
        document.getElementById('btn-save-prod').innerText = "افزودن به لیست";
        document.getElementById('btn-save-prod').style.background = "green";
        document.getElementById('btn-cancel-edit').style.display = 'none';
        document.getElementById('form-title').innerHTML = "<i class='bx bx-plus-circle'></i> افزودن کالا";
    }
    
    function deleteProductLocal(id) {
        if(confirm('آیا مطمئن هستید که این محصول حذف شود؟')) { 
            products = products.filter(p => p.id !== id); 
            localStorage.setItem('siteProducts', JSON.stringify(products)); 
            loadProducts();
            showToast('محصول حذف شد', 'error');
        }
    }

    function renderAdminCategoryToggles() {
        const container = document.getElementById('admin-cat-toggles');
        container.innerHTML = '';
        const catStates = JSON.parse(localStorage.getItem('catStates')) || defaultCatStates;
        catDefinitions.forEach(item => {
            const isChecked = catStates[item.key] !== false ? 'checked' : '';
            container.innerHTML += `
                <div class="admin-cat-item" style="display:flex; justify-content:space-between; align-items:center; background:white; padding:8px 12px; border-radius:8px; border:1px solid #eee;">
                    <label for="cat-${item.key}" style="cursor:pointer; flex:1;">${item.label}</label>
                    <input type="checkbox" id="cat-${item.key}" ${isChecked} onchange="toggleCategory('${item.key}')" style="width:20px; height:20px; cursor:pointer;">
                </div>
            `;
        });
    }
    
    function toggleCategory(key) {
        let catStates = JSON.parse(localStorage.getItem('catStates')) || defaultCatStates;
        const checkbox = document.getElementById(`cat-${key}`);
        catStates[key] = checkbox.checked;
        localStorage.setItem('catStates', JSON.stringify(catStates));
        renderMainGrid();
    }

    /* =========================================
       4. نظرات و ستاره‌دهی
       ========================================= */
    let currentRating = 0;

    function openReviewModal() {
        currentRating = 0;
        updateStarVisuals();
        document.getElementById('reviewSubmitModal').style.display = 'flex';
    }

    function setRating(n) {
        currentRating = n;
        updateStarVisuals();
    }

    function updateStarVisuals() {
        for(let i=1; i<=5; i++) {
            const star = document.getElementById(`star-${i}`);
            if(i <= currentRating) {
                star.classList.add('active');
                star.classList.remove('bx-star');
                star.classList.add('bxs-star');
            } else {
                star.classList.remove('active');
                star.classList.remove('bxs-star');
                star.classList.add('bx-star');
            }
        }
    }

    function submitReview() {
        const name = document.getElementById('reviewName').value || 'کاربر ناشناس';
        const text = document.getElementById('reviewText').value;
        if(!text.trim()) { showToast("لطفا متن نظر را بنویسید", "error"); return; }
        if(currentRating === 0) { showToast("لطفا امتیاز دهید", "error"); return; }
        const newReview = { id: Date.now(), name, text, rating: currentRating, date: new Date().toLocaleDateString('fa-IR') };
        let reviews = JSON.parse(localStorage.getItem('siteReviews')) || [];
        reviews.push(newReview);
        localStorage.setItem('siteReviews', JSON.stringify(reviews));
        document.getElementById('reviewText').value = '';
        document.getElementById('reviewName').value = '';
        document.getElementById('reviewSubmitModal').style.display = 'none';
        showToast("نظر ارزشمند شما ثبت شد", "success");
    }

    function showReviewsPanel() {
        const container = document.getElementById('reviewListContainer');
        container.innerHTML = '';
        const reviews = JSON.parse(localStorage.getItem('siteReviews')) || [];
        if (reviews.length === 0) {
            container.innerHTML = '<div style="text-align:center; padding:50px; color:#888;"><p>هیچ نظری ثبت نشده است.</p></div>';
        } else {
            reviews.reverse().forEach(r => {
                let starsHtml = '';
                for(let i=0; i<5; i++) { starsHtml += i < r.rating ? "<i class='bx bxs-star'></i>" : "<i class='bx bx-star'></i>"; }
                container.innerHTML += `
                    <div class="review-card" style="background:var(--bg-body); padding:15px; border-radius:15px; margin-bottom:15px; border:1px solid var(--border-color); position:relative;">
                        <i class='bx bxs-trash' onclick="deleteReview(${r.id})" style="position:absolute; top:15px; left:15px; color:var(--accent-red); cursor:pointer;"></i>
                        <h5>${r.name} <span class="review-stars-display">${starsHtml}</span></h5>
                        <p>${r.text}</p>
                        <span style="font-size:0.7rem; color:var(--text-light);">${r.date}</span>
                    </div>
                `;
            });
        }
        document.getElementById('reviewListModal').style.display = 'flex';
    }

    function deleteReview(id) {
        if(confirm("آیا این نظر حذف شود؟")) {
            let reviews = JSON.parse(localStorage.getItem('siteReviews')) || [];
            reviews = reviews.filter(r => r.id !== id);
            localStorage.setItem('siteReviews', JSON.stringify(reviews));
            showReviewsPanel();
        }
    }

    /* =========================================
       6. توابع کمکی و عمومی
       ========================================= */
    function togglePriceModal(){ 
        const modal = document.getElementById('priceModal');
        if(modal.classList.contains('active')) {
            modal.classList.remove('active');
            setTimeout(() => modal.style.display = 'none', 300);
        } else {
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('active'), 10);
            scrollTable('top');
        }
    }

    function scrollTable(direction) {
        const container = document.getElementById('scrollContainer');
        if (direction === 'bottom') container.scrollTo({ top: container.scrollHeight, behavior: 'smooth' });
        else container.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    function showToast(msg, type='success') { 
        const t = document.getElementById("toast"); 
        document.getElementById("toast-msg").innerText = msg; 
        t.className = "show " + type; 
        setTimeout(()=>t.className="", 3000); 
    }

    window.onscroll = function() {
        let scrolled = (document.documentElement.scrollTop / (document.documentElement.scrollHeight - document.documentElement.clientHeight)) * 100;
        document.getElementById("progress-bar").style.width = scrolled + "%";
        document.getElementById("backToTop").style.display = document.documentElement.scrollTop > 400 ? "flex" : "none";
    };

    const canvas = document.getElementById('hero-canvas'); 
    const ctx = canvas.getContext('2d'); 
    let particles = [];
    
    function initParticles() { 
        resizeCanvas();
        particles = []; 
        for(let i=0; i<60; i++) particles.push(new Particle()); 
        animateParticles(); 
    }
    
    function resizeCanvas() {
        canvas.width = window.innerWidth; 
        canvas.height = window.innerHeight;
    }
    
    class Particle { 
        constructor(){
            this.x = Math.random() * canvas.width; 
            this.y = Math.random() * canvas.height; 
            this.size = Math.random() * 3 + 1; 
            this.speedX = (Math.random() * 1) - 0.5; 
            this.speedY = (Math.random() * 1) - 0.5;
            this.opacity = Math.random() * 0.5 + 0.1;
        } 
        update(){ 
            this.x += this.speedX; 
            this.y += this.speedY; 
            if(this.x < 0 || this.x > canvas.width) this.speedX *= -1; 
            if(this.y < 0 || this.y > canvas.height) this.speedY *= -1; 
            ctx.beginPath(); 
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); 
            ctx.fillStyle = `rgba(255,255,255,${this.opacity})`; 
            ctx.fill(); 
        } 
    }
    
    function animateParticles(){ 
        ctx.clearRect(0,0,canvas.width,canvas.height); 
        particles.forEach(p => p.update()); 
        requestAnimationFrame(animateParticles); 
    }
    
    window.addEventListener('resize', resizeCanvas);

    /* =========================================
       *** منطق ماشین حساب ***
       ========================================= */
    let isScientific = false;
    function openCalculator() {
        const modal = document.getElementById('calcModalOverlay');
        modal.style.display = 'flex';
        setTimeout(() => modal.classList.add('active'), 10);
    }
    function closeCalculator() {
        const modal = document.getElementById('calcModalOverlay');
        modal.classList.remove('active');
        setTimeout(() => modal.style.display = 'none', 300);
    }
    function toggleScientificMode() {
        isScientific = !isScientific;
        const box = document.querySelector('.calc-box');
        const sciRow = document.querySelector('.sci-row');
        const btn = document.getElementById('btnSciToggle');
        if (isScientific) {
            box.classList.add('scientific'); sciRow.classList.remove('hidden');
        } else {
            box.classList.remove('scientific'); sciRow.classList.add('hidden');
        }
    }
    function calcInput(val) { document.getElementById('calcDisplay').value += val; }
    function calcClear() { document.getElementById('calcDisplay').value = ''; }
    function calcDelete() {
        const display = document.getElementById('calcDisplay');
        display.value = display.value.toString().slice(0, -1);
    }
    function calcResult() {
        const display = document.getElementById('calcDisplay');
        try { display.value = eval(display.value.replace(/\^/g, '**')); } catch (e) { display.value = 'Error'; }
    }
</script>
</body>
</html>
